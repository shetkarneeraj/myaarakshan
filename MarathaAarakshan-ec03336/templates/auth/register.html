{% extends "base.html" %}

{% block title %}‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä - ‡§Æ‡§∞‡§æ‡§†‡§æ ‡§Ü‡§∞‡§ï‡•ç‡§∑‡§£ ‡§Æ‡§Ç‡§ö{% endblock %}

{% block content %}
<div class="container py-5">
    <!-- Header -->
    <div class="row mb-5">
        <div class="col-12 text-center">
            <h1 class="display-5 text-primary mb-3">üë§ ‡§®‡§µ‡•á ‡§ñ‡§æ‡§§‡•á ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ</h1>
            <p class="lead">‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§Ü‡§£‡§ø ‡§Ö‡§ß‡§ø‡§ï ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ‡§Ç‡§∏‡§æ‡§†‡•Ä ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä ‡§ï‡§∞‡§æ</p>
        </div>
    </div>

    <!-- Registration Form -->
    <div class="row">
        <div class="col-lg-6 mx-auto">
            <div class="card border-0 shadow-lg">
                <div class="card-header bg-primary text-white text-center">
                    <h4><i class="fas fa-user-plus me-2"></i>‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä ‡§´‡•â‡§∞‡•ç‡§Æ</h4>
                </div>
                <div class="card-body p-4">
                    <form method="POST" action="{% url 'accounts:register' %}" id="registerForm">
                        <!-- Personal Information -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="full_name" class="form-label">‡§™‡•Ç‡§∞‡•ç‡§£ ‡§®‡§æ‡§µ <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="full_name" name="full_name" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="username" class="form-label">‡§µ‡§æ‡§™‡§∞‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§µ <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="username" name="username" required>
                                <div class="form-text">‡§π‡•á ‡§§‡•Å‡§Æ‡§ö‡•á ‡§≤‡•â‡§ó‡§ø‡§® ‡§®‡§æ‡§µ ‡§Ö‡§∏‡•á‡§≤</div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="email" class="form-label">‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡•ç‡§§‡§æ <span class="text-danger">*</span></label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="phone" class="form-label">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞</label>
                                <input type="tel" class="form-control" id="phone" name="phone" pattern="[0-9]{10}">
                            </div>
                        </div>

                        <!-- Password -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="password" class="form-label">‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° <span class="text-danger">*</span></label>
                                <input type="password" class="form-control" id="password" name="password" required minlength="6">
                                <div class="form-text">‡§ï‡§ø‡§Æ‡§æ‡§® 6 ‡§Ö‡§ï‡•ç‡§∑‡§∞‡•á ‡§Ö‡§∏‡§æ‡§µ‡•á‡§§</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="confirm_password" class="form-label">‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§™‡•Å‡§∑‡•ç‡§ü‡•Ä <span class="text-danger">*</span></label>
                                <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
                            </div>
                        </div>

                        <!-- Location Information -->
                        <div class="mb-3">
                            <h6 class="text-primary">‡§∏‡•ç‡§•‡§æ‡§® ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä</h6>
                            <hr>
                        </div>

                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="division_id" class="form-label">‡§µ‡§ø‡§≠‡§æ‡§ó</label>
                                <select class="form-select" id="division_id" name="division_id">
                                    <option value="">‡§µ‡§ø‡§≠‡§æ‡§ó ‡§®‡§ø‡§µ‡§°‡§æ</option>
                                    {% for division in divisions %}
                                    <option value="{{ division.id }}">{{ division.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="district_id" class="form-label">‡§ú‡§ø‡§≤‡•ç‡§π‡§æ</label>
                                <select class="form-select" id="district_id" name="district_id" disabled>
                                    <option value="">‡§™‡§π‡§ø‡§≤‡•á ‡§µ‡§ø‡§≠‡§æ‡§ó ‡§®‡§ø‡§µ‡§°‡§æ</option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="village_id" class="form-label">‡§ó‡§æ‡§µ</label>
                                <select class="form-select" id="village_id" name="village_id" disabled>
                                    <option value="">‡§™‡§π‡§ø‡§≤‡•á ‡§ú‡§ø‡§≤‡•ç‡§π‡§æ ‡§®‡§ø‡§µ‡§°‡§æ</option>
                                </select>
                            </div>
                        </div>

                        <!-- Terms and Conditions -->
                        <div class="mb-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="terms" name="terms" required>
                                <label class="form-check-label" for="terms">
                                    ‡§Æ‡•Ä <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">‡§®‡§ø‡§Ø‡§Æ ‡§Ü‡§£‡§ø ‡§Ö‡§ü‡•Ä</a> ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞‡§§‡•ã <span class="text-danger">*</span>
                                </label>
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-user-plus me-2"></i>‡§ñ‡§æ‡§§‡•á ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ
                            </button>
                        </div>

                        <!-- Login Link -->
                        <div class="text-center mt-3">
                            <p>‡§Ü‡§ß‡•Ä‡§ö ‡§ñ‡§æ‡§§‡•á ‡§Ü‡§π‡•á? <a href="{% url 'accounts:login' %}" class="text-primary">‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡§æ</a></p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Benefits Section -->
    <div class="row mt-5">
        <div class="col-12">
            <h3 class="text-center mb-4">‡§ñ‡§æ‡§§‡•ç‡§Ø‡§æ‡§ö‡•á ‡§´‡§æ‡§Ø‡§¶‡•á</h3>
            <div class="row">
                <div class="col-md-3 mb-3">
                    <div class="text-center">
                        <div class="feature-icon bg-primary text-white rounded-circle mx-auto mb-3" style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-tachometer-alt fa-2x"></i>
                        </div>
                        <h5>‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</h5>
                        <p class="text-muted">‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§∏‡§∞‡•ç‡§µ ‡§Ö‡§∞‡•ç‡§ú‡§æ‡§Ç‡§ö‡•Ä ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§è‡§ï‡§æ ‡§†‡§ø‡§ï‡§æ‡§£‡•Ä</p>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="text-center">
                        <div class="feature-icon bg-success text-white rounded-circle mx-auto mb-3" style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-bell fa-2x"></i>
                        </div>
                        <h5>‡§§‡§§‡•ç‡§ï‡§æ‡§≥ ‡§∏‡•Ç‡§ö‡§®‡§æ</h5>
                        <p class="text-muted">‡§Ö‡§∞‡•ç‡§ú‡§æ‡§ö‡•ç‡§Ø‡§æ ‡§∏‡•ç‡§•‡§ø‡§§‡•Ä‡§ö‡•Ä ‡§Ö‡§™‡§°‡•á‡§ü‡•ç‡§∏</p>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="text-center">
                        <div class="feature-icon bg-warning text-white rounded-circle mx-auto mb-3" style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-chart-line fa-2x"></i>
                        </div>
                        <h5>‡§™‡•ç‡§∞‡§ó‡§§‡•Ä ‡§ü‡•ç‡§∞‡•Ö‡§ï‡§ø‡§Ç‡§ó</h5>
                        <p class="text-muted">‡§Ö‡§∞‡•ç‡§ú‡§æ‡§ö‡•Ä ‡§ü‡§™‡•ç‡§™‡•ç‡§Ø‡§æ‡§ü‡§™‡•ç‡§™‡•ç‡§Ø‡§æ‡§®‡•á ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä</p>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="text-center">
                        <div class="feature-icon bg-info text-white rounded-circle mx-auto mb-3" style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-crown fa-2x"></i>
                        </div>
                        <h5>‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§∏‡•á‡§µ‡§æ</h5>
                        <p class="text-muted">‡§ú‡§≤‡§¶ ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Ü‡§£‡§ø ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Terms Modal -->
<div class="modal fade" id="termsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">‡§®‡§ø‡§Ø‡§Æ ‡§Ü‡§£‡§ø ‡§Ö‡§ü‡•Ä</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <h6>‡§µ‡§æ‡§™‡§∞‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§ø‡§Ø‡§Æ:</h6>
                <ul>
                    <li>‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§ñ‡§∞‡•Ä ‡§Ü‡§£‡§ø ‡§Ö‡§ö‡•Ç‡§ï ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§¶‡•á‡§£‡•ç‡§Ø‡§æ‡§∏ ‡§∏‡§π‡§Æ‡§§ ‡§Ü‡§π‡§æ‡§§</li>
                    <li>‡§¨‡§®‡§æ‡§µ‡§ü ‡§ï‡§æ‡§ó‡§¶‡§™‡§§‡•ç‡§∞‡•á ‡§µ‡§æ‡§™‡§∞‡§£‡•á ‡§ï‡§æ‡§Ø‡§¶‡•á‡§∂‡•Ä‡§∞ ‡§ó‡•Å‡§®‡•ç‡§π‡§æ ‡§Ü‡§π‡•á</li>
                    <li>‡§Ü‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§∏‡•á‡§µ‡§æ‡§Ç‡§ö‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•Ç ‡§®‡§ï‡§æ</li>
                    <li>‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§ñ‡§æ‡§§‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§ó‡•Å‡§™‡•ç‡§§ ‡§†‡•á‡§µ‡§æ</li>
                </ul>
                <h6>‡§ó‡•ã‡§™‡§®‡•Ä‡§Ø‡§§‡§æ:</h6>
                <ul>
                    <li>‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§†‡•á‡§µ‡§≤‡•Ä ‡§ú‡§æ‡§à‡§≤</li>
                    <li>‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§™‡§∞‡§µ‡§æ‡§®‡§ó‡•Ä ‡§∂‡§ø‡§µ‡§æ‡§Ø ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§∂‡•á‡§Ö‡§∞ ‡§ï‡•á‡§≤‡•Ä ‡§ú‡§æ‡§£‡§æ‡§∞ ‡§®‡§æ‡§π‡•Ä</li>
                    <li>‡§Ü‡§Æ‡•ç‡§π‡•Ä ‡§´‡§ï‡•ç‡§§ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§ó‡•ã‡§≥‡§æ ‡§ï‡§∞‡§§‡•ã</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">‡§∏‡§Æ‡§ú‡§≤‡•á</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Location cascade
document.getElementById('division_id').addEventListener('change', function() {
    const divisionId = this.value;
    const districtSelect = document.getElementById('district_id');
    const villageSelect = document.getElementById('village_id');
    
    districtSelect.innerHTML = '<option value="">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</option>';
    districtSelect.disabled = true;
    villageSelect.innerHTML = '<option value="">‡§™‡§π‡§ø‡§≤‡•á ‡§ú‡§ø‡§≤‡•ç‡§π‡§æ ‡§®‡§ø‡§µ‡§°‡§æ</option>';
    villageSelect.disabled = true;

    if (divisionId) {
        fetch(`/api/districts/${divisionId}`)
            .then(response => response.json())
            .then(districts => {
                districtSelect.innerHTML = '<option value="">‡§ú‡§ø‡§≤‡•ç‡§π‡§æ ‡§®‡§ø‡§µ‡§°‡§æ</option>';
                districts.forEach(district => {
                    districtSelect.innerHTML += `<option value="${district.id}">${district.name}</option>`;
                });
                districtSelect.disabled = false;
            });
    } else {
        districtSelect.innerHTML = '<option value="">‡§™‡§π‡§ø‡§≤‡•á ‡§µ‡§ø‡§≠‡§æ‡§ó ‡§®‡§ø‡§µ‡§°‡§æ</option>';
    }
});

document.getElementById('district_id').addEventListener('change', function() {
    const districtId = this.value;
    const villageSelect = document.getElementById('village_id');
    
    villageSelect.innerHTML = '<option value="">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</option>';
    villageSelect.disabled = true;

    if (districtId) {
        fetch(`/api/villages/${districtId}`)
            .then(response => response.json())
            .then(villages => {
                villageSelect.innerHTML = '<option value="">‡§ó‡§æ‡§µ ‡§®‡§ø‡§µ‡§°‡§æ</option>';
                villages.forEach(village => {
                    villageSelect.innerHTML += `<option value="${village.id}">${village.name}</option>`;
                });
                villageSelect.disabled = false;
            });
    } else {
        villageSelect.innerHTML = '<option value="">‡§™‡§π‡§ø‡§≤‡•á ‡§ú‡§ø‡§≤‡•ç‡§π‡§æ ‡§®‡§ø‡§µ‡§°‡§æ</option>';
    }
});

// Password confirmation
document.getElementById('confirm_password').addEventListener('input', function() {
    const password = document.getElementById('password').value;
    const confirm = this.value;
    
    if (confirm && password !== confirm) {
        this.setCustomValidity('‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§Æ‡•á‡§≥ ‡§ñ‡§æ‡§§ ‡§®‡§æ‡§π‡•Ä');
        this.classList.add('is-invalid');
    } else {
        this.setCustomValidity('');
        this.classList.remove('is-invalid');
        if (confirm) this.classList.add('is-valid');
    }
});

// Phone number formatting
document.getElementById('phone').addEventListener('input', function() {
    let value = this.value.replace(/\D/g, '');
    if (value.length > 10) value = value.slice(0, 10);
    this.value = value;
});

// Form validation
document.getElementById('registerForm').addEventListener('submit', function(e) {
    const password = document.getElementById('password').value;
    const confirm = document.getElementById('confirm_password').value;
    
    if (password !== confirm) {
        e.preventDefault();
        alert('‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§Æ‡•á‡§≥ ‡§ñ‡§æ‡§§ ‡§®‡§æ‡§π‡•Ä');
        return;
    }
    
    if (!document.getElementById('terms').checked) {
        e.preventDefault();
        alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§®‡§ø‡§Ø‡§Æ ‡§Ü‡§£‡§ø ‡§Ö‡§ü‡•Ä ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞‡§æ');
        return;
    }
});
</script>
{% endblock %}
